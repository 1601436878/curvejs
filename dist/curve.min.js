/**
 * curvejs v0.1.0 By dntzhang
 * Github: https://github.com/AlloyTeam/curvejs
 * MIT Licensed.
 */

!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.curvejs=n()}(this,function(){"use strict";function t(t,n,i,e,o,a,r){var s={x:t-i,y:n-e},c=[[Math.cos(o),-Math.sin(o)],[Math.sin(o),Math.cos(o)]];r[a]=i+c[0][0]*s.x+c[0][1]*s.y,r[a+1]=e+c[1][0]*s.x+c[1][1]*s.y}function n(n,i){var e=(n[0]+n[6])/2,o=(n[1]+n[7])/2;t(n[0],n[1],e,o,i,0,n),t(n[2],n[3],e,o,i,2,n),t(n[4],n[5],e,o,i,4,n),t(n[6],n[7],e,o,i,6,n)}function i(t,n){var i=t*t+n*n;if(0===i)return[0,0];var e=Math.sqrt(i);return[t/e,n/e]}function e(t,n){return t*t+n*n}function o(t){var n=f.n(t[0]-t[6],t[1]-t[7]);t[0]+=n[0],t[1]+=n[1],t[6]-=n[0],t[7]-=n[1]}function a(t){var n=f.n(t[0]-t[6],t[1]-t[7]);t[0]-=n[0],t[1]-=n[1],t[6]+=n[0],t[7]+=n[1]}function r(t){}function s(t,n){var i=[t[2]-t[0],t[3]-t[1]],e=[t[4]-t[2],t[5]-t[3]],o=[t[6]-t[4],t[7]-t[5]],a=[n[2]-n[0],n[3]-n[1]],r=[n[4]-n[2],n[5]-n[3]],s=[n[6]-n[4],n[7]-n[5]],c=f.n(a[0]-i[0],a[1]-i[1]);t[0]-=c[0],t[1]-=c[1];var h=f.n(r[0]-e[0],r[1]-e[1]);t[4]+=h[0],t[5]+=h[1];var u=f.n(s[0]-o[0],s[1]-o[1]);t[6]+=u[0],t[7]+=u[1]}function c(t){t[2]+=t[2]>t[0]?-1:1,t[3]+=t[3]>t[1]?-1:1,t[4]+=t[4]>t[6]?-1:1,t[5]+=t[5]>t[7]?-1:1}function h(t,n){var i=[[Math.cos(n.angle),-Math.sin(n.angle)],[Math.sin(n.angle),Math.cos(n.angle)]];this.data.angle+=n.step,t[0]=t[0]+i[0][0],t[1]=t[1]+i[1][0],t[6]=t[6]+i[0][0],t[7]=t[7]+i[1][0]}!function(){Date.now||(Date.now=function(){return(new Date).getTime()});for(var t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n){var i=t[n];window.requestAnimationFrame=window[i+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i+"CancelAnimationFrame"]||window[i+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var e=0;window.requestAnimationFrame=function(t){var n=Date.now(),i=Math.max(e+16,n);return setTimeout(function(){t(e=i)},i-n)},window.cancelAnimationFrame=clearTimeout}}();var u=function(t,n){var i=this.copyPoints,e=n.angle,o=n.r,a=[[Math.cos(e),-Math.sin(e)],[Math.sin(e),Math.cos(e)]];t[0]=i[0]+a[0][0]*o,t[1]=i[1]+a[1][0]*o,t[2]=i[2]+a[0][0]*o,t[3]=i[3]+a[1][0]*o,t[4]=i[4]+a[0][0]*o,t[5]=i[5]+a[1][0]*o,t[6]=i[6]+a[0][0]*o,t[7]=i[7]+a[1][0]*o,n.angle+=n.step},l=function(t,n){t.forEach(function(i,e){t[e]+=n[e]})},f={n:i,sl:e},v={close:a,open:o,auto:r},d={dance:u,move:l,rotate:n,to:s,line:c,circle:h,close:v.close,open:v.open},p=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},w=function(){function t(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,i,e){return i&&t(n.prototype,i),e&&t(n,e),n}}(),m=function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)},y=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n},g=function(){function t(n){p(this,t),this.points=n.points||[],this.color=n.color||"black",this.x=n.x||0,this.y=n.y||0,this.vision=n.vision||[],this.visionMax=640,this.visionInterval=n.visionInterval||10,this._preDate=Date.now(),this._now=new Date,this.data=n.data,this.copyPoints=this.points.slice(0),this.motion=n.motion||d.dance,this._initVision(n.visionCount||80)}return w(t,[{key:"_initVision",value:function(){for(var t=0;t<80;t++)this.tick(!0)}},{key:"tick",value:function(t){this._now=Date.now(),(this._now-this._preDate>this.visionInterval||t)&&(this.vision.push.apply(this.vision,this.points),this.vision.length>this.visionMax&&this.vision.splice(0,8),this._preDate=this._now),this.motion.call(this,this.points,this.data)}},{key:"draw",value:function(t){this.tick(),t.save(),t.translate(this.x,this.y),t.globalAlpha=1;var n=this.points;t.beginPath(),t.strokeStyle=this.color,t.moveTo.call(t,n[0],n[1]),t.bezierCurveTo.call(t,n[2],n[3],n[4],n[5],n[6],n[7]),t.stroke();for(var i=this.vision,e=0,o=i.length;e<o;e+=8)t.globalAlpha=e/this.visionMax*.1,t.beginPath(),t.moveTo.call(t,i[e],i[e+1]),t.bezierCurveTo.call(t,i[e+2],i[e+3],i[e+4],i[e+5],i[e+6],i[e+7]),t.stroke();t.restore()}},{key:"clone",value:function(){}}]),t}(),b=function(){function t(){p(this,t),this.children=[]}return w(t,[{key:"add",value:function(t){this.children.push(t)}},{key:"remove",value:function(t){for(var n=0,i=this.children.length;n<i;n++)if(t===this.children[n]){this.children.splice(n,1);break}}},{key:"draw",value:function(t){this.children.forEach(function(n){n.draw(t)})}}]),t}(),x=function(t){function n(t,i,e){p(this,n);var o=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return 1===arguments.length?(o.canvas=t,o.ctx=o.canvas.getContext("2d"),o.width=o.canvas.width,o.height=o.canvas.height):3===arguments.length&&(o.canvas=document.createElement("canvas"),o.canvas.width=t,o.canvas.height=i,o.width=t,o.height=i,o.ctx=o.canvas.getContext("2d"),document.querySelector(e).appendChild(o.canvas)),o}return m(n,t),w(n,[{key:"addExistLine",value:function(t){}},{key:"sameAs",value:function(t){}},{key:"update",value:function(){var t=this;this.ctx.clearRect(0,0,this.width,this.height),this.children.forEach(function(n){n.draw(t.ctx)})}}]),n}(b),_={c:[[70,70,12,76,12,123,70,128]],u:[[25,68,23,140,80,140,74,100],[73,62,72,90,75,110,93,134]],r:[[21,62,21,62,21,128,21,128],[21,128,17,96,17,68,65,60]],v:[[12,58,41,132,61,132,96,58]],j:[[52,48,53,48,54,49,52,48],[8,175,24,204,60,197,56,74]],e:[[44,104,112,52,-20,82,77,136]],s:[[81,72,17,42,105,145,41,120]],l:[[77,27,30,114,36,126,57,126]],i:[[56,71,56,72,59,70,56,73],[47,93,59,81,47,121,59,111]]},k=function(t){function n(t,i){p(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return i=Object.assign({x:0,y:0,color:"black"},i),e.x=i.x,e.y=i.y,e.color=i.color,e.word=t,e.data=i.data,e.motion=i.motion,e.points=_[t],e._init(),e}return m(n,t),w(n,[{key:"_init",value:function(){var t=this;this.points.forEach(function(n){t.add(new g({x:t.x,y:t.y,points:n,color:t.color,data:t.data,motion:t.motion}))})}}]),n}(b);return{Curve:g,Group:b,Stage:x,motion:d,Word:k}});
