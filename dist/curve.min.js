/**
 * curvejs v0.3.0 By dntzhang
 * Github: https://github.com/AlloyTeam/curvejs
 * MIT Licensed.
 */

!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.curvejs=n()}(this,function(){"use strict";function t(t,n,i,e,o,a,s){var r={x:t-i,y:n-e},c=[[Math.cos(o),-Math.sin(o)],[Math.sin(o),Math.cos(o)]];s[a]=i+c[0][0]*r.x+c[0][1]*r.y,s[a+1]=e+c[1][0]*r.x+c[1][1]*r.y}function n(n,i){var e=(n[0]+n[6])/2,o=(n[1]+n[7])/2;t(n[0],n[1],e,o,i,0,n),t(n[2],n[3],e,o,i,2,n),t(n[4],n[5],e,o,i,4,n),t(n[6],n[7],e,o,i,6,n)}function i(t,n){var i=t*t+n*n;if(0===i)return[0,0];var e=Math.sqrt(i);return[t/e,n/e]}function e(t,n){return t*t+n*n}function o(t){var n=v.n(t[0]-t[6],t[1]-t[7]);t[0]+=n[0],t[1]+=n[1],t[6]-=n[0],t[7]-=n[1]}function a(t){var n=v.n(t[0]-t[6],t[1]-t[7]);t[0]-=n[0],t[1]-=n[1],t[6]+=n[0],t[7]+=n[1]}function s(t){}function r(t,n){var i=[t[2]-t[0],t[3]-t[1]],e=[t[4]-t[2],t[5]-t[3]],o=[t[6]-t[4],t[7]-t[5]],a=[n[2]-n[0],n[3]-n[1]],s=[n[4]-n[2],n[5]-n[3]],r=[n[6]-n[4],n[7]-n[5]],c=v.n(a[0]-i[0],a[1]-i[1]);t[0]-=c[0],t[1]-=c[1];var h=v.n(s[0]-e[0],s[1]-e[1]);t[4]+=h[0],t[5]+=h[1];var u=v.n(r[0]-o[0],r[1]-o[1]);t[6]+=u[0],t[7]+=u[1]}function c(t){t[2]+=t[2]>t[0]?-1:1,t[3]+=t[3]>t[1]?-1:1,t[4]+=t[4]>t[6]?-1:1,t[5]+=t[5]>t[7]?-1:1}function h(t,n){var i=[[Math.cos(n.angle),-Math.sin(n.angle)],[Math.sin(n.angle),Math.cos(n.angle)]];this.data.angle+=n.step,t[0]=t[0]+i[0][0],t[1]=t[1]+i[1][0],t[6]=t[6]+i[0][0],t[7]=t[7]+i[1][0]}function u(t,n,i,e,o){var a=t.x,s=t.y,r=n.x,c=n.y,h=i.x,u=i.y,l=e.x,f=e.y,p=(r-a)*o+a,v=(c-s)*o+s,d=(h-r)*o+r,y=(u-c)*o+c,w=(l-h)*o+h,m=(f-u)*o+u,_=(d-p)*o+p,g=(y-v)*o+v;return[a,s,p,v,_,g,((w-d)*o+d-_)*o+_,((m-y)*o+y-g)*o+g]}!function(){Date.now||(Date.now=function(){return(new Date).getTime()});for(var t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n){var i=t[n];window.requestAnimationFrame=window[i+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i+"CancelAnimationFrame"]||window[i+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var e=0;window.requestAnimationFrame=function(t){var n=Date.now(),i=Math.max(e+16,n);return setTimeout(function(){t(e=i)},i-n)},window.cancelAnimationFrame=clearTimeout}}();var l,f=function(t,n){var i=this.copyPoints,e=n.angle,o=n.r,a=[[Math.cos(e),-Math.sin(e)],[Math.sin(e),Math.cos(e)]];t[0]=i[0]+a[0][0]*o,t[1]=i[1]+a[1][0]*o,t[2]=i[2]+a[0][0]*o,t[3]=i[3]+a[1][0]*o,t[4]=i[4]+a[0][0]*o,t[5]=i[5]+a[1][0]*o,t[6]=i[6]+a[0][0]*o,t[7]=i[7]+a[1][0]*o,n.angle+=n.step},p=function(t,n){t.forEach(function(i,e){t[e]+=n[e]})},v={n:i,sl:e},d={close:a,open:o,auto:s},y=function(t,n){n.value-=n.step,n.value<0&&(n.value=0);var i=u({x:this.copyPoints[0],y:this.copyPoints[1]},{x:this.copyPoints[2],y:this.copyPoints[3]},{x:this.copyPoints[4],y:this.copyPoints[5]},{x:this.copyPoints[6],y:this.copyPoints[7]},n.value);t.forEach(function(n,e){t[e]=i[e]})},w={},m=4,_=.5,g=function(t){return.5*(1-Math.cos(t*Math.PI))};w.noise=function(t,n,i){if(n=n||0,i=i||0,null==l){l=new Array(4096);for(var e=0;e<4096;e++)l[e]=Math.random()}t<0&&(t=-t),n<0&&(n=-n),i<0&&(i=-i);for(var o,a,s,r,c,h=Math.floor(t),u=Math.floor(n),f=Math.floor(i),p=t-h,v=n-u,d=i-f,y=0,w=.5,x=0;x<m;x++){var b=h+(u<<4)+(f<<8);o=g(p),a=g(v),s=l[4095&b],s+=o*(l[b+1&4095]-s),r=l[b+16&4095],r+=o*(l[b+16+1&4095]-r),s+=a*(r-s),b+=256,r=l[4095&b],r+=o*(l[b+1&4095]-r),c=l[b+16&4095],c+=o*(l[b+16+1&4095]-c),r+=a*(c-r),s+=g(d)*(r-s),y+=s*w,w*=_,h<<=1,p*=2,u<<=1,v*=2,f<<=1,d*=2,p>=1&&(h++,p--),v>=1&&(u++,v--),d>=1&&(f++,d--)}return y},w.noiseDetail=function(t,n){t>0&&(m=t),n>0&&(_=n)},w.noiseSeed=function(t){var n=function(){var t,n,i=4294967296;return{setSeed:function(e){n=t=(null==e?Math.random()*i:e)>>>0},getSeed:function(){return t},rand:function(){return(n=(1664525*n+1013904223)%i)/i}}}();n.setSeed(t),l=new Array(4096);for(var i=0;i<4096;i++)l[i]=n.rand()};var x=function(t,n){n.value+=n.step,t[0]=n.width*w.noise(n.value+15),t[1]=n.height*w.noise(n.value+25),t[2]=n.width*w.noise(n.value+35),t[3]=n.height*w.noise(n.value+45),t[4]=n.width*w.noise(n.value+55),t[5]=n.height*w.noise(n.value+65),t[6]=n.width*w.noise(n.value+75),t[7]=n.height*w.noise(n.value+85)},b={dance:f,move:p,rotate:n,to:r,line:c,circle:h,close:d.close,open:d.open,expand:y,noise:x},P=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},k=function(){function t(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,i,e){return i&&t(n.prototype,i),e&&t(n,e),n}}(),M=function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)},T=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n},A=function(){function t(n){P(this,t),this.points=n.points||[],this.color=n.color||"black",this.x=n.x||0,this.y=n.y||0,this.vision=n.vision||[],this.visionMax=640,this.visionInterval=n.visionInterval||10,this._preDate=Date.now(),this._now=new Date,this.data=n.data,this._noop=function(){},this._ease=function(t){return t},this._targetPoints=null,this.copyPoints=this.points.slice(0),this.motion=n.motion||this._noop,(void 0===n.initVision||n.initVision)&&this._initVision(n.visionCount||80)}return k(t,[{key:"_initVision",value:function(){for(var t=0;t<80;t++)this.tick(!0)}},{key:"tick",value:function(t){this._now=Date.now(),(this._now-this._preDate>this.visionInterval||t)&&(this.vision.push.apply(this.vision,this.points),this.vision.length>this.visionMax&&this.vision.splice(0,8),this._preDate=this._now),this.pauseMotion||this.motion.call(this,this.points,this.data),this._targetPoints&&this._pointsTo()}},{key:"pause",value:function(){this.pauseMotion=!0}},{key:"play",value:function(){this.pauseMotion=!1}},{key:"draw",value:function(t){this.tick(),t.save(),t.translate(this.x,this.y),t.globalAlpha=1;var n=this.points;t.beginPath(),t.strokeStyle=this.color,t.moveTo.call(t,n[0],n[1]),t.bezierCurveTo.call(t,n[2],n[3],n[4],n[5],n[6],n[7]),t.stroke();for(var i=this.vision,e=0,o=i.length;e<o;e+=8)t.globalAlpha=e/this.visionMax*.1,t.beginPath(),t.moveTo.call(t,i[e],i[e+1]),t.bezierCurveTo.call(t,i[e+2],i[e+3],i[e+4],i[e+5],i[e+6],i[e+7]),t.stroke();t.restore()}},{key:"pointsTo",value:function(t,n,i){this.pause();var e=this.points;this._targetPoints=t,this._pto=i,this._ptStart=i.start||this._noop,this._ptProgress=i.progress||this._noop,this._ptEnd=i.end||this._noop,this._ptEase=i.ease||this._ease,this._ptTime=n,this._ptStartTime=Date.now(),this._ptCopyPoints=e.slice(0),this._ptDistance=[t[0]-e[0],t[1]-e[1],t[2]-e[2],t[3]-e[3],t[4]-e[4],t[5]-e[5],t[6]-e[6],t[7]-e[7]],this._ptStart.call(this,0)}},{key:"translatePoints",value:function(t,n,i){t=Object.assign({x:0,y:0},t);var e=this.points;this.pointsTo([e[0]+t.x,e[1]+t.y,e[2]+t.x,e[3]+t.y,e[4]+t.x,e[5]+t.y,e[6]+t.x,e[7]+t.y],n,i)}},{key:"_pointsTo",value:function(){var t=this,n=this.points,i=Date.now()-this._ptStartTime;if(i<this._ptTime){var e=i/this._ptTime;n.forEach(function(i,o){n[o]=t._ptCopyPoints[o]+t._ptDistance[o]*t._ptEase(e)}),this._ptProgress.call(this,e)}else n=this._targetPoints.slice(0),this._ptEnd.call(this,1),this._targetPoints=null}},{key:"colorTo",value:function(){}},{key:"clone",value:function(){}}]),t}(),D=function(){function t(){P(this,t),this.children=[]}return k(t,[{key:"add",value:function(t){this.children.push(t)}},{key:"remove",value:function(t){for(var n=0,i=this.children.length;n<i;n++)if(t===this.children[n]){this.children.splice(n,1);break}}},{key:"draw",value:function(t){this.children.forEach(function(n){n.draw(t)})}}]),t}(),E=function(t){function n(t,i,e){P(this,n);var o=T(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return 1===arguments.length?(o.canvas=t,o.ctx=o.canvas.getContext("2d"),o.width=o.canvas.width,o.height=o.canvas.height):3===arguments.length&&(o.canvas=document.createElement("canvas"),o.canvas.width=t,o.canvas.height=i,o.width=t,o.height=i,o.ctx=o.canvas.getContext("2d"),document.querySelector(e).appendChild(o.canvas)),o}return M(n,t),k(n,[{key:"update",value:function(){var t=this;this.ctx.clearRect(0,0,this.width,this.height),this.children.forEach(function(n){n.draw(t.ctx)})}},{key:"addExistLine",value:function(t){}},{key:"sameAs",value:function(t){}}]),n}(D),O={c:[[70,70,12,76,12,123,70,128]],u:[[25,68,23,140,80,140,74,100],[73,62,72,90,75,110,93,134]],r:[[21,62,21,62,21,128,21,128],[21,128,17,96,17,68,65,60]],v:[[12,58,41,132,61,132,96,58]],e:[[44,104,112,52,-20,82,77,136]],j:[[52,48,53,48,54,49,52,48],[8,175,24,204,60,197,56,74]],s:[[81,72,17,42,105,145,41,120]],l:[[77,27,30,114,36,126,57,126]],i:[[56,71,56,72,59,70,56,73],[47,93,59,81,47,121,59,111]]},S=function(t){function n(t,i){P(this,n);var e=T(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return i=Object.assign({x:0,y:0,color:"black"},i),e.x=i.x,e.y=i.y,e.color=i.color,e.word=t,e.data=i.data,e.motion=i.motion,e.points=O[t],e._init(),e}return M(n,t),k(n,[{key:"_init",value:function(){var t=this;this.points.forEach(function(n){t.add(new A({x:t.x,y:t.y,points:n,color:t.color,data:t.data,motion:t.motion}))})}}]),n}(D);return{Curve:A,Group:D,Stage:E,motion:b,Word:S,perlin:w}});
