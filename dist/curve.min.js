/**
 * curvejs v0.2.0 By dntzhang
 * Github: https://github.com/AlloyTeam/curvejs
 * MIT Licensed.
 */

!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.curvejs=i()}(this,function(){"use strict";function t(t,i,n,o,e,s,a){var r={x:t-n,y:i-o},c=[[Math.cos(e),-Math.sin(e)],[Math.sin(e),Math.cos(e)]];a[s]=n+c[0][0]*r.x+c[0][1]*r.y,a[s+1]=o+c[1][0]*r.x+c[1][1]*r.y}function i(i,n){var o=(i[0]+i[6])/2,e=(i[1]+i[7])/2;t(i[0],i[1],o,e,n,0,i),t(i[2],i[3],o,e,n,2,i),t(i[4],i[5],o,e,n,4,i),t(i[6],i[7],o,e,n,6,i)}function n(t,i){var n=t*t+i*i;if(0===n)return[0,0];var o=Math.sqrt(n);return[t/o,i/o]}function o(t,i){return t*t+i*i}function e(t){var i=f.n(t[0]-t[6],t[1]-t[7]);t[0]+=i[0],t[1]+=i[1],t[6]-=i[0],t[7]-=i[1]}function s(t){var i=f.n(t[0]-t[6],t[1]-t[7]);t[0]-=i[0],t[1]-=i[1],t[6]+=i[0],t[7]+=i[1]}function a(t){}function r(t,i){var n=[t[2]-t[0],t[3]-t[1]],o=[t[4]-t[2],t[5]-t[3]],e=[t[6]-t[4],t[7]-t[5]],s=[i[2]-i[0],i[3]-i[1]],a=[i[4]-i[2],i[5]-i[3]],r=[i[6]-i[4],i[7]-i[5]],c=f.n(s[0]-n[0],s[1]-n[1]);t[0]-=c[0],t[1]-=c[1];var h=f.n(a[0]-o[0],a[1]-o[1]);t[4]+=h[0],t[5]+=h[1];var u=f.n(r[0]-e[0],r[1]-e[1]);t[6]+=u[0],t[7]+=u[1]}function c(t){t[2]+=t[2]>t[0]?-1:1,t[3]+=t[3]>t[1]?-1:1,t[4]+=t[4]>t[6]?-1:1,t[5]+=t[5]>t[7]?-1:1}function h(t,i){var n=[[Math.cos(i.angle),-Math.sin(i.angle)],[Math.sin(i.angle),Math.cos(i.angle)]];this.data.angle+=i.step,t[0]=t[0]+n[0][0],t[1]=t[1]+n[1][0],t[6]=t[6]+n[0][0],t[7]=t[7]+n[1][0]}function u(t,i,n,o,e){var s=t.x,a=t.y,r=i.x,c=i.y,h=n.x,u=n.y,l=o.x,p=o.y,f=(r-s)*e+s,v=(c-a)*e+a,y=(h-r)*e+r,d=(u-c)*e+c,w=(l-h)*e+h,_=(p-u)*e+u,m=(y-f)*e+f,g=(d-v)*e+v;return[s,a,f,v,m,g,((w-y)*e+y-m)*e+m,((_-d)*e+d-g)*e+g]}!function(){Date.now||(Date.now=function(){return(new Date).getTime()});for(var t=["webkit","moz"],i=0;i<t.length&&!window.requestAnimationFrame;++i){var n=t[i];window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var o=0;window.requestAnimationFrame=function(t){var i=Date.now(),n=Math.max(o+16,i);return setTimeout(function(){t(o=n)},n-i)},window.cancelAnimationFrame=clearTimeout}}();var l=function(t,i){var n=this.copyPoints,o=i.angle,e=i.r,s=[[Math.cos(o),-Math.sin(o)],[Math.sin(o),Math.cos(o)]];t[0]=n[0]+s[0][0]*e,t[1]=n[1]+s[1][0]*e,t[2]=n[2]+s[0][0]*e,t[3]=n[3]+s[1][0]*e,t[4]=n[4]+s[0][0]*e,t[5]=n[5]+s[1][0]*e,t[6]=n[6]+s[0][0]*e,t[7]=n[7]+s[1][0]*e,i.angle+=i.step},p=function(t,i){t.forEach(function(n,o){t[o]+=i[o]})},f={n:n,sl:o},v={close:s,open:e,auto:a},y=function(t,i){i.value-=i.step,i.value<0&&(i.value=0);var n=u({x:this.copyPoints[0],y:this.copyPoints[1]},{x:this.copyPoints[2],y:this.copyPoints[3]},{x:this.copyPoints[4],y:this.copyPoints[5]},{x:this.copyPoints[6],y:this.copyPoints[7]},i.value);t.forEach(function(i,o){t[o]=n[o]})},d={dance:l,move:p,rotate:i,to:r,line:c,circle:h,close:v.close,open:v.open,expand:y},w=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},_=function(){function t(t,i){for(var n=0;n<i.length;n++){var o=i[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(i,n,o){return n&&t(i.prototype,n),o&&t(i,o),i}}(),m=function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)},g=function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i},x=function(){function t(i){w(this,t),this.points=i.points||[],this.color=i.color||"black",this.x=i.x||0,this.y=i.y||0,this.vision=i.vision||[],this.visionMax=640,this.visionInterval=i.visionInterval||10,this._preDate=Date.now(),this._now=new Date,this.data=i.data,this._noop=function(){},this._ease=function(t){return t},this._targetPoints=null,this.copyPoints=this.points.slice(0),this.motion=i.motion||this._noop,(void 0===i.initVision||i.initVision)&&this._initVision(i.visionCount||80)}return _(t,[{key:"_initVision",value:function(){for(var t=0;t<80;t++)this.tick(!0)}},{key:"tick",value:function(t){this._now=Date.now(),(this._now-this._preDate>this.visionInterval||t)&&(this.vision.push.apply(this.vision,this.points),this.vision.length>this.visionMax&&this.vision.splice(0,8),this._preDate=this._now),this.pauseMotion||this.motion.call(this,this.points,this.data),this._targetPoints&&this._pointsTo()}},{key:"pause",value:function(){this.pauseMotion=!0}},{key:"play",value:function(){this.pauseMotion=!1}},{key:"draw",value:function(t){this.tick(),t.save(),t.translate(this.x,this.y),t.globalAlpha=1;var i=this.points;t.beginPath(),t.strokeStyle=this.color,t.moveTo.call(t,i[0],i[1]),t.bezierCurveTo.call(t,i[2],i[3],i[4],i[5],i[6],i[7]),t.stroke();for(var n=this.vision,o=0,e=n.length;o<e;o+=8)t.globalAlpha=o/this.visionMax*.1,t.beginPath(),t.moveTo.call(t,n[o],n[o+1]),t.bezierCurveTo.call(t,n[o+2],n[o+3],n[o+4],n[o+5],n[o+6],n[o+7]),t.stroke();t.restore()}},{key:"pointsTo",value:function(t,i,n){this.pause();var o=this.points;this._targetPoints=t,this._pto=n,this._ptStart=n.start||this._noop,this._ptProgress=n.progress||this._noop,this._ptEnd=n.end||this._noop,this._ptEase=n.ease||this._ease,this._ptTime=i,this._ptStartTime=Date.now(),this._ptCopyPoints=o.slice(0),this._ptDistance=[t[0]-o[0],t[1]-o[1],t[2]-o[2],t[3]-o[3],t[4]-o[4],t[5]-o[5],t[6]-o[6],t[7]-o[7]],this._ptStart.call(this,0)}},{key:"translatePoints",value:function(t,i,n){t=Object.assign({x:0,y:0},t);var o=this.points;this.pointsTo([o[0]+t.x,o[1]+t.y,o[2]+t.x,o[3]+t.y,o[4]+t.x,o[5]+t.y,o[6]+t.x,o[7]+t.y],i,n)}},{key:"_pointsTo",value:function(){var t=this,i=this.points,n=Date.now()-this._ptStartTime;if(n<this._ptTime){var o=n/this._ptTime;i.forEach(function(n,e){i[e]=t._ptCopyPoints[e]+t._ptDistance[e]*t._ptEase(o)}),this._ptProgress.call(this,o)}else i=this._targetPoints.slice(0),this._ptEnd.call(this,1),this._targetPoints=null}},{key:"colorTo",value:function(){}},{key:"clone",value:function(){}}]),t}(),b=function(){function t(){w(this,t),this.children=[]}return _(t,[{key:"add",value:function(t){this.children.push(t)}},{key:"remove",value:function(t){for(var i=0,n=this.children.length;i<n;i++)if(t===this.children[i]){this.children.splice(i,1);break}}},{key:"draw",value:function(t){this.children.forEach(function(i){i.draw(t)})}}]),t}(),k=function(t){function i(t,n,o){w(this,i);var e=g(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return 1===arguments.length?(e.canvas=t,e.ctx=e.canvas.getContext("2d"),e.width=e.canvas.width,e.height=e.canvas.height):3===arguments.length&&(e.canvas=document.createElement("canvas"),e.canvas.width=t,e.canvas.height=n,e.width=t,e.height=n,e.ctx=e.canvas.getContext("2d"),document.querySelector(o).appendChild(e.canvas)),e}return m(i,t),_(i,[{key:"update",value:function(){var t=this;this.ctx.clearRect(0,0,this.width,this.height),this.children.forEach(function(i){i.draw(t.ctx)})}},{key:"addExistLine",value:function(t){}},{key:"sameAs",value:function(t){}}]),i}(b),P={c:[[70,70,12,76,12,123,70,128]],u:[[25,68,23,140,80,140,74,100],[73,62,72,90,75,110,93,134]],r:[[21,62,21,62,21,128,21,128],[21,128,17,96,17,68,65,60]],v:[[12,58,41,132,61,132,96,58]],e:[[44,104,112,52,-20,82,77,136]],j:[[52,48,53,48,54,49,52,48],[8,175,24,204,60,197,56,74]],s:[[81,72,17,42,105,145,41,120]],l:[[77,27,30,114,36,126,57,126]],i:[[56,71,56,72,59,70,56,73],[47,93,59,81,47,121,59,111]]},M=function(t){function i(t,n){w(this,i);var o=g(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return n=Object.assign({x:0,y:0,color:"black"},n),o.x=n.x,o.y=n.y,o.color=n.color,o.word=t,o.data=n.data,o.motion=n.motion,o.points=P[t],o._init(),o}return m(i,t),_(i,[{key:"_init",value:function(){var t=this;this.points.forEach(function(i){t.add(new x({x:t.x,y:t.y,points:i,color:t.color,data:t.data,motion:t.motion}))})}}]),i}(b);return{Curve:x,Group:b,Stage:k,motion:d,Word:M}});
